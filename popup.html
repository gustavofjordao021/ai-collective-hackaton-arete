<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif&family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="popup.compiled.css">
</head>
<body class="w-[380px] bg-arete-bg font-sans text-arete-text p-5">

  <!-- Header -->
  <header class="flex justify-between items-center pb-5 border-b border-arete-border">
    <div class="flex items-center gap-3">
      <div class="w-10 h-10 bg-arete-accent rounded-xl flex items-center justify-center text-white font-serif text-xl">
        A
      </div>
      <div>
        <h1 class="font-serif text-xl tracking-tight">Arete</h1>
        <p class="text-xs text-arete-text-tertiary">Your AI, elevated</p>
      </div>
    </div>
    <button id="auth-btn" class="flex items-center gap-2 px-4 py-2 border border-arete-border rounded-lg text-sm font-medium hover:border-arete-border-hover hover:bg-arete-surface transition-colors">
      Sign in
    </button>
  </header>

  <!-- Stats Section -->
  <section class="mt-6">
    <div class="flex items-center gap-2 mb-4">
      <span class="text-xs font-mono text-arete-text-tertiary">01</span>
      <span class="text-xs text-arete-text-tertiary">::</span>
      <span class="text-xs font-semibold uppercase tracking-wider text-arete-text-secondary">Memory Stats</span>
    </div>
    <div class="grid grid-cols-3 gap-3" id="stats-grid">
      <!-- Facts Card -->
      <div class="bg-arete-surface border border-arete-border rounded-xl p-4 hover:border-arete-border-hover transition-colors">
        <div class="flex items-baseline gap-1">
          <span class="font-mono text-2xl font-medium" id="facts-count">-</span>
          <span class="font-mono text-xs text-arete-text-tertiary" id="facts-limit">/50</span>
        </div>
        <p class="text-xs text-arete-text-tertiary mt-1">Facts</p>
        <div class="h-1 bg-arete-border rounded-full mt-3 overflow-hidden">
          <div class="h-full bg-arete-accent rounded-full transition-all" id="facts-bar" style="width: 0%"></div>
        </div>
      </div>

      <!-- Pages Card -->
      <div class="bg-arete-surface border border-arete-border rounded-xl p-4 hover:border-arete-border-hover transition-colors">
        <div class="flex items-baseline gap-1">
          <span class="font-mono text-2xl font-medium" id="pages-count">-</span>
          <span class="font-mono text-xs text-arete-text-tertiary" id="pages-limit">/20</span>
        </div>
        <p class="text-xs text-arete-text-tertiary mt-1">Pages</p>
        <div class="h-1 bg-arete-border rounded-full mt-3 overflow-hidden">
          <div class="h-full bg-arete-accent rounded-full transition-all" id="pages-bar" style="width: 0%"></div>
        </div>
      </div>

      <!-- Messages Card -->
      <div class="bg-arete-accent-light border border-arete-accent/30 rounded-xl p-4">
        <div class="flex items-baseline gap-1">
          <span class="font-mono text-2xl font-medium text-arete-accent" id="messages-count">-</span>
        </div>
        <p class="text-xs text-arete-accent mt-1">Messages</p>
      </div>
    </div>
    <p class="text-center text-[10px] text-arete-text-tertiary mt-3">
      Storage: <span id="storage-size">0 KB</span>
    </p>
  </section>

  <!-- Facts Section -->
  <section class="mt-6">
    <div class="flex items-center gap-2 mb-4">
      <span class="text-xs font-mono text-arete-text-tertiary">02</span>
      <span class="text-xs text-arete-text-tertiary">::</span>
      <span class="text-xs font-semibold uppercase tracking-wider text-arete-text-secondary">Learned Facts</span>
    </div>
    <div class="bg-arete-surface border border-arete-border rounded-xl max-h-32 overflow-y-auto" id="facts-list">
      <p class="px-4 py-8 text-center text-sm text-arete-text-tertiary italic">No facts learned yet</p>
    </div>
  </section>

  <!-- Identity Section -->
  <section class="mt-6">
    <div class="flex items-center justify-between mb-4">
      <div class="flex items-center gap-2">
        <span class="text-xs font-mono text-arete-text-tertiary">03</span>
        <span class="text-xs text-arete-text-tertiary">::</span>
        <span class="text-xs font-semibold uppercase tracking-wider text-arete-text-secondary">Identity</span>
      </div>
      <div class="flex bg-arete-surface rounded-lg p-1" id="identity-tabs">
        <button class="tab-btn px-3 py-1.5 text-xs font-medium rounded-md bg-white shadow-sm text-arete-text" id="tab-view" data-tab="view">View</button>
        <button class="tab-btn px-3 py-1.5 text-xs font-medium rounded-md text-arete-text-tertiary hover:text-arete-text-secondary" id="tab-edit" data-tab="edit">Edit</button>
      </div>
    </div>

    <div id="view-panel">
      <div class="bg-arete-surface border border-arete-border rounded-xl p-4">
        <p id="identity-preview" class="text-sm text-arete-text-secondary whitespace-pre-wrap leading-relaxed">Loading...</p>
      </div>
    </div>

    <div id="edit-panel" class="hidden">
      <textarea
        id="identity-input"
        class="w-full min-h-[140px] p-4 bg-arete-surface border border-arete-border rounded-xl text-sm resize-y focus:outline-none focus:border-arete-accent focus:ring-2 focus:ring-arete-accent/20"
        placeholder="Tell me about yourself...

Example:
I'm Alex, a senior engineer at a fintech startup. I work with TypeScript and React. I prefer direct, concise responses with code examples."
      ></textarea>
      <button id="save-identity-btn" class="w-full mt-3 py-3 bg-arete-accent text-white font-medium rounded-xl hover:bg-arete-accent/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
        Save Identity
      </button>
      <p id="save-status" class="text-xs text-center mt-2"></p>
    </div>
  </section>

  <!-- Actions Section -->
  <section class="mt-6">
    <div class="flex items-center gap-2 mb-4">
      <span class="text-xs font-mono text-arete-text-tertiary">04</span>
      <span class="text-xs text-arete-text-tertiary">::</span>
      <span class="text-xs font-semibold uppercase tracking-wider text-arete-text-secondary">Actions</span>
    </div>
    <div class="flex gap-3">
      <button id="export-btn" class="flex-1 py-2.5 px-4 border border-arete-border rounded-lg text-sm font-medium text-arete-text-secondary hover:border-arete-border-hover hover:bg-arete-surface transition-colors">Export</button>
      <button id="import-btn" class="flex-1 py-2.5 px-4 border border-arete-border rounded-lg text-sm font-medium text-arete-text-secondary hover:border-arete-border-hover hover:bg-arete-surface transition-colors">Import</button>
      <button id="clear-btn" class="flex-1 py-2.5 px-4 border border-red-200 rounded-lg text-sm font-medium text-red-500 hover:border-red-300 hover:bg-red-50 transition-colors">Clear</button>
    </div>
  </section>

  <!-- Hotkeys Footer -->
  <footer class="mt-6 pt-4 border-t border-arete-border">
    <div class="flex gap-6 text-xs text-arete-text-tertiary">
      <div class="flex items-center gap-2">
        <kbd class="px-2 py-1 bg-arete-surface border border-arete-border rounded font-mono text-[10px]">Cmd+Shift+O</kbd>
        <span>Open overlay</span>
      </div>
      <div class="flex items-center gap-2">
        <kbd class="px-2 py-1 bg-arete-surface border border-arete-border rounded font-mono text-[10px]">Cmd+Shift+I</kbd>
        <span>Inject identity</span>
      </div>
    </div>
  </footer>

  <script src="popup.js"></script>
</body>
</html>
